<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>com.ericsson.oss.cba.mediation</groupId>
		<artifactId>hello-vertical-slice</artifactId>
		<version>1.0.0-SNAPSHOT</version>
		<relativePath>../pom.xml</relativePath>
	</parent>
	<groupId>com.ericsson.oss.cba</groupId>
	<artifactId>hello-vertical-slice-tests</artifactId>
	<version>1.0.0-SNAPSHOT</version>
	
	<url>http://www.ericsson.com</url>
	<organization>
		<name>Ericsson</name>
	</organization>

	<prerequisites>
		<maven>3.0.3</maven>
	</prerequisites>

	<name>${project.artifactId}</name>

	<properties>
		<version.mdt>1.0.14</version.mdt>
		<versant.db.host>localhost</versant.db.host>
		<models.location>${basedir}/src/test/resources/xml</models.location>
		<model.output.directory>${project.build.directory}/model-xmls</model.output.directory>
		<model.expected.directory>${model.output.directory}/modeling/etc/model</model.expected.directory>
		<model.jar.directory>${project.build.directory}/test-models</model.jar.directory>
		<test.model>test-model</test.model>
		<model.root>${project.build.directory}/deployed-model</model.root>
		<xml.repo>${model.root}/modelRepo.xml</xml.repo>
		<dps.conf.models.jar.name>dps-conf-models-jar-xml.jar</dps.conf.models.jar.name>
		<model.jars.output>target/model-jars</model.jars.output>
		<tunnel.script>tunnel_doozers.sh</tunnel.script>
		<!-- The default gateway config file if it's not provided by user. User 
			can override this value by providing "-Dgateway.config.file" when builiding. 
			Example: mvn clean install -Dgateway.config.file=<new_gateway_name.vpn> -->
		<gateway.config.file>atvts70.vpn</gateway.config.file>
		
	</properties>

	<dependencies>
		<!-- added because of problems with javax.jee -->
		<dependency>
			<groupId>org.jboss.spec</groupId>
			<artifactId>jboss-javaee-6.0</artifactId>
			<type>pom</type>
	    </dependency>
		<dependency>
			<groupId>com.ericsson.oss.mediation</groupId>
			<artifactId>mediation-core-api-event-models-jar</artifactId>
			<version>${version.core.api.event.model}</version>
			<scope>test</scope>
		</dependency>
		<!-- the two APIs need to be included here so maven resolver can load them -->
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>mediation-core-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.mediation</groupId>
			<artifactId>mediation-core-service-locator-api</artifactId>
			<scope>test</scope>
		</dependency>
		<!--<dependency>
			<groupId>${project.groupId}</groupId>
			<artifactId>cm-mediation-vertical-slice-handler-code</artifactId>
			<version>${project.version}</version>
			<scope>test</scope>
		</dependency>-->
		<dependency>
			<groupId>org.jboss.as</groupId>
			<artifactId>jboss-as-arquillian-container-managed</artifactId>
			<version>${version.arq.jboss.as}</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.jboss.arquillian.protocol</groupId>
			<artifactId>arquillian-protocol-servlet</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
			<artifactId>dps-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>core-mediation-engine-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>core-mediation-dsl-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.sdk</groupId>
			<artifactId>sdk-config-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
			<artifactId>data-access-delegate-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.jboss.arquillian.junit</groupId>
			<artifactId>arquillian-junit-container</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.jboss.shrinkwrap.resolver</groupId>
			<artifactId>shrinkwrap-resolver-impl-maven</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>mediation-service-ear</artifactId>
			<type>ear</type>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>mediation-service-engine</artifactId>
			<type>ejb</type>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>mediation-core-ear</artifactId>
			<type>ear</type>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>mediation-core-ejb</artifactId>
			<type>ejb</type>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.datalayer.modeling</groupId>
			<artifactId>modeling-common-jar</artifactId>
			<version>${version.modeling.common.jar}</version>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>camel-engine-jca-flow-rar</artifactId>
			<type>rar</type>
			<version>${version.camel.engine}</version>
			<scope>test</scope>
		</dependency>
		<!-- Additional dependencies needed for sending of registration event -->
		<dependency>
			<groupId>com.ericsson.nms.mediation</groupId>
			<artifactId>core-mediation-models-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.sdk</groupId>
			<artifactId>sdk-modeled-eventbus-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.sdk</groupId>
			<artifactId>sdk-modeled-eventbus</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.sdk</groupId>
			<artifactId>sdk-cache-infinispan</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.sdk</groupId>
			<artifactId>sdk-config-cache</artifactId>
			<scope>test</scope>
		</dependency>
		<!-- End of additional dependencies needed for sending registration event -->
		<dependency>
			<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
			<artifactId>dps-remote-api</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>com.ericsson.oss.itpf.sdk</groupId>
			<artifactId>sdk-cluster-core</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.directory.studio</groupId>
			<artifactId>org.apache.commons.io</artifactId>
			<version>2.4</version>
			<scope>test</scope>
		</dependency>
		
		<dependency>
			<groupId>com.ericsson.oss.cba.mediation.flow.handler.hello</groupId>
			<artifactId>hello-handler-ear</artifactId>
			<version>${version.hello.handler.ear}</version>
			<type>ear</type>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>org.jboss.as.camel</groupId>
			<artifactId>camel-engine-ear</artifactId>
			<version>${version.camel.engine}</version>
			<type>ear</type>
		</dependency>
	</dependencies>
	<build>
		<plugins>
			<plugin>
				<groupId>org.jboss.as.plugins</groupId>
				<artifactId>jboss-as-maven-plugin</artifactId>
				<configuration>
					<filename>${project.parent.artifactId}.${project.packaging}</filename>
					<skip>false</skip>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-dependency-plugin</artifactId>
				<executions>
					<execution>
						<id>download-models</id>
						<phase>initialize</phase>
						<goals>
							<goal>copy</goal>
						</goals>
						<configuration>
							<artifactItems>
								<artifactItem>
									<groupId>com.ericsson.oss.mediation</groupId>
									<artifactId>mediation-sdk-event-models-xml</artifactId>
									<version>${version.sdk.event.model}</version>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.mediation</groupId>
									<artifactId>mediation-core-api-channel-models-xml</artifactId>
									<version>${version.core.api.channel.model}</version>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.mediation</groupId>
									<artifactId>mediation-core-api-event-models-xml</artifactId>
									<version>${version.core.api.event.model}</version>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.mediation</groupId>
									<artifactId>mediation-core-api-configuration-models-xml</artifactId>
									<version>${version.core.api.config.model}</version>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.mediation</groupId>
									<artifactId>mediation-core-cache-definition-models-xml</artifactId>
									<version>${version.core.cache.model}</version>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.mediation</groupId>
									<artifactId>mediation-service-configuration-models-xml</artifactId>
									<version>${version.service.config.model}</version>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.datalayer.dps.model</groupId>
									<artifactId>dps-conf-models-jar</artifactId>
									<classifier>xml</classifier>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jar.home}</outputDirectory>
									<!-- The version of the of the jar is specified via a property in 
										the DPS BOM which be cannot read transitively. Therefore the file is renamed 
										to strip out the version, so as to prevent problems during the MDT plugin 
										section below. -->
									<destFileName>${dps.conf.models.jar.name}</destFileName>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.services</groupId>
									<artifactId>OssTop-model</artifactId>
									<version>${version.OssTop.model}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.services.erbs.nrm.native</groupId>
									<artifactId>ERBSNetworkResourceModels-jar</artifactId>
									<version>${version.ERBSNetworkResourceModels}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.services.cpp.nrm.native</groupId>
									<artifactId>CPPNetworkResourceModels-jar</artifactId>
									<version>${version.CPPNetworkResourceModels}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.services.cpp.nrm.conninfo</groupId>
									<artifactId>CPPConnectivityInfoModels-model</artifactId>
									<version>${version.CPPConnectivityInfoModels}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.models.base.conninfo</groupId>
									<artifactId>BASEConnectivityInfoModel-model</artifactId>
									<version>${version.BASEConnectivityInfoModel}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.cba.mediation.flows</groupId>
									<artifactId>hello-flow-model</artifactId>
									<version>${version.HelloFlowModel}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								
								<artifactItem>
									<groupId>com.ericsson.oss.cba.mediation.config</groupId>
									<artifactId>hello-mediation-configuration-model</artifactId>
									<version>${version.HelloMediationConfigurationModel}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.cba.mediation.flow.handler.model</groupId>
									<artifactId>hello-handler-model</artifactId>
									<version>${version.HelloHandlerModel}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<outputDirectory>${model.jars.output}</outputDirectory>
								</artifactItem>
							</artifactItems>
						</configuration>
					</execution>
					<execution>
						<id>unpack</id>
						<phase>generate-sources</phase>
						<goals>
							<goal>unpack</goal>
						</goals>

						<configuration>
							<ignoreDirect>false</ignoreDirect>
							<artifactItems>
								<artifactItem>
									<groupId>org.jboss.as</groupId>
									<artifactId>jboss-as-dist</artifactId>
									<version>${version.jboss.as}</version>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>target/</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.sdk</groupId>
									<artifactId>ServiceFrameworkBundle-zip</artifactId>
									<classifier>CXP9030097</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.sdk</groupId>
									<artifactId>ServiceFrameworkBundle-zip</artifactId>
									<version>${version.sfwk.secondary}</version>
									<classifier>CXP9030097</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.nms.mediation</groupId>
									<artifactId>core-mediation-engine-api-module</artifactId>
									<classifier>engine-api-module</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
									<artifactId>dps-api-module</artifactId>
									<classifier>package</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
									<artifactId>data-access-delegate-api-module</artifactId>
									<classifier>package</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
									<artifactId>dps-remote-api-module</artifactId>
									<classifier>package</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.nms.mediation</groupId>
									<artifactId>contrib-module</artifactId>
									<version>${version.camel.engine}</version>
									<type>zip</type>
									<overWrite>true</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.nms.mediation</groupId>
									<artifactId>camel-module</artifactId>
									<version>${version.camel.engine}</version>
									<type>zip</type>
									<overWrite>true</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<!-- Model service API -->
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.modeling</groupId>
									<artifactId>model-service-api-module</artifactId>
									<type>zip</type>
									<classifier>package</classifier>
									<overWrite>true</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<!-- Model service IMPL -->
								<artifactItem>
									<groupId>com.ericsson.oss.itpf.modeling</groupId>
									<artifactId>model-service-module</artifactId>
									<type>zip</type>
									<classifier>package</classifier>
									<overWrite>true</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<!-- Camel Subsystem -->
								<artifactItem>
									<groupId>org.jboss.as.camel</groupId>
									<artifactId>subsystem</artifactId>
									<version>${version.camel.engine}</version>
									<type>zip</type>
									<overWrite>true</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>org.jboss.as.camel</groupId>
									<artifactId>camel-jboss-module</artifactId>
									<version>${version.camel.engine}</version>
									<type>zip</type>
									<overWrite>true</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
								<artifactItem>
									<groupId>com.ericsson.nms.mediation</groupId>
									<artifactId>core-mediation-engine-api-module</artifactId>
									<version>${version.mediation.sdk}</version>
									<classifier>engine-api-module</classifier>
									<type>zip</type>
									<overWrite>false</overWrite>
									<outputDirectory>${jboss.home.module.dir}</outputDirectory>
								</artifactItem>
							</artifactItems>
						</configuration>
					</execution>
				</executions>
			</plugin>


			<!-- <plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-dependency-plugin</artifactId>
				<executions>
					<execution>
						<id>copy</id>
						<phase>generate-sources</phase>
						<goals>
							<goal>copy</goal>
						</goals>
						<configuration>
							<artifactItems>
								<artifactItem>
									<groupId>${project.groupId}</groupId>
									<artifactId>hello-vertical-slice-handler-code</artifactId>
									<version>${project.version}</version>
									<type>jar</type>
									<overWrite>false</overWrite>
									<destFileName>hello-vertical-slice-handler-code-${project.version}.jar</destFileName>
									<outputDirectory>${jboss.home.module.dir}/com/ericsson/oss/mediation/engine/contrib/main</outputDirectory>
								</artifactItem>
							</artifactItems>
						</configuration>
					</execution>
				</executions>
			</plugin> -->
			<plugin>
				<artifactId>maven-resources-plugin</artifactId>
				<executions>
					<execution>
						<id>copy-contrib-module-xml</id>
						<phase>generate-sources</phase>
						<goals>
							<goal>copy-resources</goal>
						</goals>
						<configuration>
							<overwrite>true</overwrite>
							<outputDirectory>${jboss.home.module.dir}/com/ericsson/oss/mediation/engine/contrib/main</outputDirectory>
							<resources>
								<resource>
									<directory>src/test/resources</directory>
									<includes>
										<include>module.xml</include>
									</includes>
									<filtering>true</filtering>
								</resource>
							</resources>
						</configuration>
					</execution>
					<execution>
						<id>copy-resources-standalone-files</id>
						<phase>process-resources</phase>
						<goals>
							<goal>copy-resources</goal>
						</goals>
						<configuration>
							<overwrite>true</overwrite>
							<outputDirectory>${jboss.home}/standalone/configuration/</outputDirectory>
							<resources>
								<resource>
									<directory>src/test/resources/jboss_settings/standalone/configuration/</directory>
									<includes>
										<include>*.*</include>
									</includes>
									<filtering>false</filtering>
								</resource>
							</resources>
						</configuration>
					</execution>
				</executions>
			</plugin>

			<!-- As the versant and non versant tests both use model-service then 
				they both need to copy the model xml's via the model deployment tool to a 
				"well-known location" -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-resources-plugin</artifactId>
				<executions>
					<execution>
						<id>copy-model</id>
						<phase>generate-resources</phase>
						<goals>
							<goal>copy-resources</goal>
						</goals>
						<configuration>
							<includeEmptyDirs>false</includeEmptyDirs>
							<outputDirectory>${model.expected.directory}</outputDirectory>
							<resources>
								<resource>
									<directory>src/test/resources/xml</directory>
									<includes>
										<include>**/*.xml</include>
									</includes>
									<filtering>true</filtering>
								</resource>
							</resources>
						</configuration>
					</execution>
				</executions>
			</plugin>

			<!-- Packages the model xml's stored in a "well-known location" into a 
				jar to be deployed using the mdt -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jar-plugin</artifactId>
				<configuration>
					<classesDirectory>${model.output.directory}</classesDirectory>
					<finalName>${test.model}</finalName>
					<outputDirectory>${model.jar.directory}</outputDirectory>
				</configuration>
				<executions>
					<execution>
						<id>create-jar</id>
						<phase>process-resources</phase>
						<goals>
							<goal>jar</goal>
						</goals>
					</execution>
				</executions>
			</plugin>

			<plugin>
				<groupId>com.ericsson.oss.itpf.modeling</groupId>
				<artifactId>model-deployment-jar</artifactId>
				<version>${version.mdt}</version>
				<dependencies>
					<dependency>
						<groupId>com.ericsson.oss.itpf.modeling</groupId>
						<artifactId>default-mdt-plugins-jar</artifactId>
						<version>${version.mdt}</version>
					</dependency>
				</dependencies>
				<configuration>
					<jarFiles>
						<param>${model.jars.output}/CPPNetworkResourceModels-jar-${version.CPPNetworkResourceModels}.jar</param>
						<param>${model.jars.output}/ERBSNetworkResourceModels-jar-${version.ERBSNetworkResourceModels}.jar</param>
						<param>${model.jars.output}/OssTop-model-${version.OssTop.model}.jar</param>
						<param>${model.jars.output}/CPPConnectivityInfoModels-model-${version.CPPConnectivityInfoModels}.jar</param>
						<param>${model.jars.output}/BASEConnectivityInfoModel-model-${version.BASEConnectivityInfoModel}.jar</param>

						<param>${model.jars.output}/hello-mediation-configuration-model-${version.HelloMediationConfigurationModel}.jar</param>
						<param>${model.jars.output}/hello-flow-model-${version.HelloFlowModel}.jar</param>
						<param>${model.jars.output}/hello-handler-model-${version.HelloHandlerModel}.jar</param>
												
						<param>${model.jar.home}/mediation-sdk-event-models-xml-${version.sdk.event.model}.jar</param>
						<param>${model.jar.home}/mediation-core-api-channel-models-xml-${version.core.api.channel.model}.jar</param>
						<param>${model.jar.home}/mediation-core-api-event-models-xml-${version.core.api.event.model}.jar</param>
						<param>${model.jar.home}/mediation-core-api-configuration-models-xml-${version.core.api.config.model}.jar</param>
						<param>${model.jar.home}/mediation-core-cache-definition-models-xml-${version.core.cache.model}.jar</param>
						<param>${model.jar.home}/mediation-service-configuration-models-xml-${version.service.config.model}.jar</param>
						<param>${model.jar.home}/${dps.conf.models.jar.name}</param>

						<param>${model.jar.directory}/${test.model}.jar</param>
					</jarFiles>
					<modelRoot>${model.root}</modelRoot>
					<xmlRepo>${xml.repo}</xmlRepo>
				</configuration>
				<executions>
					<execution>
						<id>deploy-model</id>
						<phase>generate-test-sources</phase>
						<goals>
							<goal>model-deploy</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
			<plugin>	<!-- Start of DPS Plugin here -->
				<groupId>com.ericsson.oss.itpf.datalayer.dps</groupId>
				<artifactId>dps-maven-plugin</artifactId>
				<version>${version.dps.maven.plugin}</version>
				<configuration>
					<workDir>${project.build.directory}/dps_work</workDir>
					<outputDir>${project.build.directory}/dps_work</outputDir>
					<modelDir>${model.root}</modelDir>
					<modelRepoXmlPath>${xml.repo}</modelRepoXmlPath>
					<jBossDir>${project.build.directory}/jboss-eap-6.1</jBossDir>
					<dbHostName>${versant.db.host}</dbHostName>
					<dbName>doozers_db</dbName>
					<schemaUpdate>true</schemaUpdate>
					<useMockDelegate>false</useMockDelegate>
				</configuration>
				<executions>
					<execution>
						<id>run-dps-maven-plugin</id>
						<phase>process-test-sources</phase>
						<goals>
							<goal>build-dps</goal>
						</goals>
					</execution>
				</executions>
			</plugin>

			<!-- Plugin to set up/exit tunnel to cloud gateway -->

			<plugin>
				<artifactId>maven-antrun-plugin</artifactId>
				<version>1.6</version>
				<executions>
					<execution>
						<id>VERIFY_GATEWAY</id>
						<phase>clean</phase>
						<configuration>
							<tasks>
								<taskdef resource="net/sf/antcontrib/antcontrib.properties"
									classpathref="maven.plugin.classpath" />
								<if>
									<equals arg1="${gateway.config.file}" arg2="atvts70.vpn" />
									<then>
										<echo
											message="No Gateway config file provied. Will set up the tunnel before test towards default Gateway as: ${gateway.config.file}." />
										<echo
											message="If you want to use a specific gateway , please rebuild and specify the gateway config file using -Dgateway.config.file=new_gateway_name.vpn" />
									</then>
									<else>
										<echo
											message="Will set up the tunnel shortly towards new Gateway as provided by user : ${gateway.config.file}" />
									</else>
								</if>
							</tasks>
						</configuration>
						<goals>
							<goal>run</goal>
						</goals>
					</execution>
					<!--<execution>
						<id>PERMISSION</id>
						<phase>process-test-resources</phase>
						<configuration>
							<target>
								<echo message="Changing permissions for ${tunnel.script}" />
								<exec executable="chmod" dir="src/test/resources"
									failonerror="true">
									<arg value="+x" />
									<arg value="${tunnel.script}" />
								</exec>
							</target>
						</configuration>
						<goals>
							<goal>run</goal>
						</goals>
					</execution>
					<execution>
						<id>SETUP</id>
						<phase>test-compile</phase>
						<configuration>
							<target>
								<echo
									message="About to set up the tunnel to gateway: ${gateway.config.file}" />
								<exec executable="sh" dir="src/test/resources" spawn="true">
									<arg value="${tunnel.script}" />
									<arg value="-a" />
									<arg value="setUp" />
									<arg value="-g" />
									<arg value="${gateway.config.file}" />
								</exec>
							</target>
						</configuration>
						<goals>
							<goal>run</goal>
						</goals>
					</execution>
					<execution>
						<id>EXIT</id>
						<phase>package</phase>
						<configuration>
							<target>
								<echo
									message="About to exit from the tunnel to gateway: ${gateway.config.file}" />
								<exec executable="sh" dir="src/test/resources">
									<arg value="${tunnel.script}" />
									<arg value="-a" />
									<arg value="exit" />
									<arg value="-g" />
									<arg value="${gateway.config.file}" />
								</exec>
							</target>
						</configuration>
						<goals>
							<goal>run</goal>
						</goals>
					</execution>-->
				</executions>
				<dependencies>
					<dependency>
						<groupId>ant-contrib</groupId>
						<artifactId>ant-contrib</artifactId>
						<version>20020829</version>
					</dependency>
				</dependencies>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-plugin</artifactId>
				<configuration>
					<threadCount>5</threadCount>
					<systemProperties>
						<jboss.home>${jboss.home}</jboss.home>
						<cache.home>${cache.home}</cache.home>
						<dps.ear.location>${dps.ear.location}</dps.ear.location>
						<dps.ear.deployment.location>${dps.ear.deployment.location}</dps.ear.deployment.location>
						<arquillian.launch>jboss_managed</arquillian.launch>
					</systemProperties>
				</configuration>
			</plugin>

		</plugins>
		<testResources>
			<testResource>
				<directory>${basedir}/src/test/resources</directory>
				<filtering>true</filtering>
				<includes>
					<include>MANIFEST.MF</include>
					<include>module.xml</include>
				</includes>
			</testResource>
			<testResource>
				<directory>${basedir}/src/test/resources</directory>
				<excludes>
					<exclude>MANIFEST.MF</exclude>
					<exclude>module.xml</exclude>
				</excludes>
				<filtering>false</filtering>
			</testResource>
		</testResources>
		<pluginManagement>
			<plugins>

				<plugin>
					<groupId>org.eclipse.m2e</groupId>
					<artifactId>lifecycle-mapping</artifactId>
					<version>1.0.0</version>
					<configuration>
						<lifecycleMappingMetadata>
							<pluginExecutions>
								<pluginExecution>
									<pluginExecutionFilter>
										<groupId>
											com.ericsson.oss.itpf.modeling
										</groupId>
										<artifactId>
											model-deployment-jar
										</artifactId>
										<versionRange>
											[1.0.14,)
										</versionRange>
										<goals>
											<goal>model-deploy</goal>
										</goals>
									</pluginExecutionFilter>
									<action>
										<ignore></ignore>
									</action>
								</pluginExecution>
								<pluginExecution>
									<pluginExecutionFilter>
										<groupId>
											org.apache.maven.plugins
										</groupId>
										<artifactId>
											maven-jar-plugin
										</artifactId>
										<versionRange>
											[2.4,)
										</versionRange>
										<goals>
											<goal>jar</goal>
										</goals>
									</pluginExecutionFilter>
									<action>
										<ignore></ignore>
									</action>
								</pluginExecution>
							</pluginExecutions>
						</lifecycleMappingMetadata>
					</configuration>
				</plugin>
			</plugins>
		</pluginManagement>
	</build>
</project>
